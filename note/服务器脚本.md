------
## **线上维护流程**

------
### 服务端版本

| 版本 | 名字        | 代码版本 | 脚本目录（脚本服） |
| :------- | ----------- | -------- | ------------------ |
| 旧公会   | old_gonghui | v12      | /data/ctl/zll3d    |
| 神起公会 | gonghui     | v14      | /data/ctl/zll3d    |
| 返利     | fanli       | v15      | /data/ctl/zll3d    |
| 买量     | mailiang    | v17      | /data/ctl/zll3d    |
| 繁体     | fanti       | v20      | /data/ctl/zll3dtw  |


### 热更（以返利版本为例）

```bash
## 连接到脚本服 47.97.181.102 (zll-3d-devlop-脚本服)
cd /data/ctl/zll3d
./release.sh -a beam -d fanli -f "gm" -v v15 # 脚本服本地数据同步到中控服 121.199.63.150(zll3D-center)

## 连接到中控服 121.199.63.150(zll3D-center)
cd /data/ctl/
./cc.py -a beams # 将要更新的文件同步到所有线上设备
./cc.py -a hotfix_files -e "gm" -v v15 # 给线上所有服热更指定文件
```

### 发布
``` bash
upload sql_file => arpg.sql
screen -f hf ???
edit config.sh
./release.sh -a beam -d longhuang_stable -f all -v v16
./release.sh -a sql -v v16
```

------
## **中控服 /data/ctl**
------
``` bash
./cc.py -a scripts                                         # 同步运维工具
./cc.py -a game -n 1001 1002 -e "start"                    # 指定单服game.sh
./cc.py -a game -v v1 -e "start"                           # 批量全服game.sh
./cc.py -a hotfix [-n "单服"|-v 版本]                        # 热更
./cc.py -a hotsql [-n "单服"|-v 版本]                        # 执行sql
./cc.py -a ssh -n 1001                                      # ssh到指定服务器
./cc.py -a weblog                                           # 收集center_sdk下log>目录
./cc.py -a dump [-n "单服"|-v 版本]                          # 备份下载指定服务器
./cc.py -a upload -n '1001'                                 # 恢复覆盖线上数据库
./cc.py -a devdump -n 1001 1002                             # 线上数据库恢复到开发服
./cc.py -a hotfix_files [-n 单服|-v 版本] -e "file1,file2"

./cc.py -a merge -n '1001'                                  # 清理从服文件
./cc.py -a creategame -n 1001 1002                          # 搭建新服
```

注意：海外版本的中控不能直连(除非翻墙)，只能通过脚本服跳转，跳转的ssh脚本在 /data/ctl/zll3dtw/，可以只用 ./ssh_center.sh


想要查看线上的游戏服，应该在中控服，用命令 ./cc.py -a ssh -n 服ID  来跳转到指定服，繁体也一样

------
## **运营同步服**

------
> (策划有需要同步的，可以直接同步这个目录)
> /data/game/yunying

> 同步脚本
> /data/util/cp_ebin.sh longhuang_dev yunying

> 如果数据库有改还需要跑一下sql
> 然后热更或者重启




------
## **学习内容**

------
mydumper
rsync
ansible
filebeat
